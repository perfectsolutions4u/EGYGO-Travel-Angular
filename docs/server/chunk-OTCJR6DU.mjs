import './polyfills.server.mjs';
import{a as G}from"./chunk-TG5RHDTU.mjs";import{a as R}from"./chunk-GR3J6XBL.mjs";import"./chunk-2UYROUIQ.mjs";import{a as A}from"./chunk-CB27RKX2.mjs";import"./chunk-OBY7IK52.mjs";import{Ca as T,Cc as V,Fc as M,Ga as n,Gb as c,Ha as h,Ib as l,Pb as D,Qb as F,Wb as L,Xa as v,Y as y,Yb as $,Za as u,bd as j,da as x,db as m,ea as C,eb as I,gb as w,hb as P,ib as r,jb as a,kb as g,lb as B,mb as E,ob as b,rb as S,tb as d,zc as z}from"./chunk-JRUE2OIN.mjs";import"./chunk-VVCT4QZE.mjs";var H=()=>["/checkout"];function N(i,s){if(i&1&&c(0),i&2){let e=d().$implicit;l(" ",e.adults," Adults ")}}function O(i,s){if(i&1&&c(0),i&2){let e=d().$implicit;l(" ",e.children," Children ")}}function U(i,s){if(i&1&&c(0),i&2){let e=d().$implicit;l(" ",e.infants," infants ")}}function q(i,s){if(i&1){let e=b();r(0,"div",6)(1,"h5",10),c(2),a(),r(3,"div",11)(4,"figure",12),g(5,"img",13),a()(),r(6,"div",14)(7,"figcaption",15)(8,"div",16)(9,"h2",17),c(10),a(),r(11,"i",18),S("click",function(){let o=x(e).$implicit,p=d(2);return C(p.deleteCart(o.tour.id))}),a()(),r(12,"div",19)(13,"div")(14,"p",20),c(15),L(16,"date"),a(),r(17,"p",20),c(18," guests: "),v(19,N,1,1)(20,O,1,1)(21,U,1,1),a()(),r(22,"span",21),c(23),a()()()()()}if(i&2){let e=s.$implicit,t=s.$index;n(2),l(" tour (",t+1,") "),n(3),u("src",e.tour.featured_image,T)("alt",e.tour.title)("title",e.tour.title),n(5),l(" ",e.tour.title," "),n(5),l(" Reservation: ",$(16,10,e.start_date,"dd/MM/yyyy")," "),n(4),m(19,e.adults>0?19:-1),n(),m(20,e.children>0?20:-1),n(),m(21,e.infants>0?21:-1),n(2),l("$ ",e.totalPrice,"")}}function J(i,s){if(i&1){let e=b();r(0,"div",5),w(1,q,24,13,"div",6,I),r(3,"div",7)(4,"button",8),S("click",function(){x(e);let o=d();return C(o.clearCart())}),c(5," clear cart "),a(),r(6,"button",9),c(7," checkout "),a()()()}if(i&2){let e=d();n(),P(e.tourCart),n(5),u("routerLink",F(1,H))}}function K(i,s){i&1&&(B(0),r(1,"p",22),c(2," no cart avaliable "),a(),E())}var it=(()=>{class i{constructor(e,t){this._BookingService=e,this.toaster=t,this.bannerTitle="cart",this.tourCart=[],this.haveData=!1,this.totalPrice=0}ngOnInit(){this.getListCart()}getListCart(){this._BookingService.getCartList().subscribe({next:e=>{this.tourCart=e.data,this.tourCart.length===0?(this.haveData=!1,console.log(this.tourCart)):(this.haveData=!0,console.log(this.tourCart),this.tourCart.forEach(t=>{let o=0,p=0,_=0;if(t.tour?.pricing_groups?.length>0){let f=t.tour.pricing_groups.find(k=>t.adults>=k.from&&t.adults<=k.to);f?(o=f.price,p=f.child_price):(o=t.tour.adult_price,p=t.tour.child_price,_=t.tour.infant_price)}else o=t.tour.adult_price,p=t.tour.child_price,_=t.tour.infant_price;t.adultPrice=o,t.childPrice=p,t.infantPrice=_,t.totalPrice=t.adults*t.adultPrice+t.children*t.childPrice+t.infants*t.infantPrice}))},error:e=>{}})}deleteCart(e){this._BookingService.deleteTourCart(e).subscribe({next:t=>{this.toaster.success(t.message),this.getListCart()},error:t=>{this.toaster.error(t.error.message)}})}clearCart(){this._BookingService.clearTourCart().subscribe({next:e=>{this.toaster.success(e.message),this.getListCart()},error:e=>{this.toaster.error(e.error.message)}})}static{this.\u0275fac=function(t){return new(t||i)(h(G),h(R))}}static{this.\u0275cmp=y({type:i,selectors:[["app-cart"]],standalone:!0,features:[D],decls:5,vars:3,consts:[[1,"mb-5"],[3,"bannerTitle"],[1,"my-5"],["class","container",4,"ngIf"],[4,"ngIf"],[1,"container"],[1,"row","align-items-center","g-3","mt-4","p-3","border","specialBorder"],[1,"flexCenter","my-4"],[1,"btn","btn-danger","rounded-pill","text-capitalize","py-2",3,"click"],[1,"mainBtn","Btn","flexCenter","gap-2","m-2","mb-2",3,"routerLink"],[1,"fw-bold","text-capitalize","h3","text-black"],[1,"col-md-3","flex-shrink-0"],[1,"specialBorder","overflow-hidden","imgHover"],["height","200px","loading","lazy",1,"w-100",3,"src","alt","title"],[1,"col-md-9"],[1,"textSecondColor"],[1,"flexBetween"],[1,"fw-bold","text-capitalize","h4","pe-3"],[1,"fa","fa-trash-can","text-danger","fs-5","flex-shrink-0","cPointer",3,"click"],[1,"flexBetween","text-capitalize"],[1,"mb-0"],[1,"textSecondColor","fw-bolder","fs-5","flex-shrink-0","cPointer","align-self-end"],[1,"text-capitalize","text-danger","fs-1","text-center"]],template:function(t,o){t&1&&(r(0,"div",0),g(1,"app-banner",1),a(),r(2,"section",2),v(3,J,8,2,"div",3)(4,K,3,0,"ng-container",4),a()),t&2&&(n(),u("bannerTitle",o.bannerTitle),n(2),u("ngIf",o.haveData),n(),u("ngIf",!o.haveData))},dependencies:[j,M,z,V,A]})}}return i})();export{it as CartComponent};
